<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><meta property="og:title" content="Tina"><meta name="twitter:title" content="Tina"><!-- <meta property="og:url" content={canonicalHref} /> --><meta name="generator" content="Astro v5.13.7"><title>Tina</title><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- <link rel="canonical" href={canonicalHref} /> --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.U4jOVs4w.js"></script><link rel="stylesheet" href="/_astro/_scene_.CLByPAuj.css">
<link rel="stylesheet" href="/_astro/index.BLNA0wXg.css">
<style>.astro-route-announcer{position:absolute;left:0;top:0;clip:rect(0 0 0 0);clip-path:inset(50%);overflow:hidden;white-space:nowrap;width:1px;height:1px}pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-built_in,.hljs-class .hljs-title,.hljs-title.class_{color:#e6c07b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}a[data-astro-cid-j7pv25f6]{color:var(--primary)}.tina-logo[data-astro-cid-j7pv25f6]{filter:grayscale(1) contrast(1.6) brightness(4) opacity(.8)}
</style></head> <body> <img class="absolute w-0 h-0" src="https://librecounter.org/counter.svg" loading="eager" decoding="async" referrerpolicy="unsafe-url" id="libre-counter"> <p class="text-xs font-mono p-2 text-neutral-400 leading-5 break-all"> <a href="/" class="hover:text-white">Home</a>  </p>  <main class="flex flex-col gap-12 p-2 justify-center w-full max-w-2xl m-auto" data-astro-cid-j7pv25f6> <img src="/_astro/tina.4YsElRAf.jpeg" alt="Tina logo" class="tina-logo" data-astro-cid-j7pv25f6> <div data-astro-cid-j7pv25f6> <p data-astro-cid-j7pv25f6>Tina... Ray-marching engine for P5js ðŸ˜Ž</p> <p data-astro-cid-j7pv25f6>
Try it by copying this <a href="https://editor.p5js.org/moloxe/sketches/Mmk8d_crf" target="_blank" data-astro-cid-j7pv25f6>sketch</a> or any of the examples:
</p> </div> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z2gLGLW" prefix="r1" component-url="/_astro/TinaExamples.BcWZBiAu.js" component-export="default" renderer-url="/_astro/client.CimA0ymp.js" props="{&quot;examples&quot;:[1,[[0,{&quot;route&quot;:[0,&quot;basic-2d-vector-field&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(width, height)\n\n  tina.build(/* glsl */ `\n    #define scale vec2(3.)\n\n    vec2 getTarget(vec2 origin) {\n      float x = origin.x;\n      float y = origin.y;\n      return vec2(\n        x*x - y*y - 4.,\n        2. * x*y\n      );\n    }\n\n    ---\n\n    vec2 xy = uv.xy * 2. - 1.;\n    xy *= vec2(width / height, -1.);\n\n    vec2 origin = xy * scale;\n    vec2 target = getTarget(origin);\n\n    float t = sin(time + PI) * .5 + .5;\n    target = (1. - t) * origin + t * target;\n\n    float angleO = atan(origin.y, origin.x);\n    float angleT = atan(target.y, target.x);\n\n    float eDist = length(origin - target);\n    float aDist = getAngularDist(angleO, angleT);\n    aDist = aDist / (2. * PI);\n\n    vec3 c = hsv2rgb(vec3(aDist, 1., log(1. + eDist)));\n\n    fragColor = vec4(c, 1.0);\n  `)\n}\n\nfunction draw() {\n  const graphics = tina.update()\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;basic-camera-green-screen&quot;],&quot;sketch&quot;:[0,&quot;let capture, tina\n\nfunction setup() {\n  const RATIO = windowWidth / windowHeight\n  createCanvas(windowWidth, windowHeight)\n  const dim = [width, height]\n  capture = createCapture(VIDEO, { flipped: false })\n  capture.size(...dim)\n  capture.hide()\n\n  tina = new Tina(...dim)\n\n  tina.build(/* glsl */ `\n    // https://www.shadertoy.com/view/llBGWc\n    #define padding 0.05\n    #define threshold 0.55\n    uniform sampler2D capture;\n    const float ratio = (4. / 3.) / ${RATIO.toFixed(4)};\n\n    vec4 getBg() {\n      vec2 xy = uv.xy * 2. - 1.;\n      xy *= vec2(width / height, -1.);\n      \n      vec2 origin = xy * 3.;\n      float x = origin.x;\n      float y = origin.y;\n      vec2 target = vec2(x * x - y * y - 4., 2. * x * y);\n\n      float t = sin(time + PI) * .5 + .5;\n      target = (1. - t) * origin + t * target;\n\n      float angleO = atan(origin.y, origin.x);\n      float angleT = atan(target.y, target.x);\n\n      float eDist = length(origin - target);\n      float aDist = getAngularDist(angleO, angleT);\n      aDist = aDist / (2. * PI);\n\n      vec3 bg = hsv2rgb(vec3(aDist, 1., log(1. + eDist)));\n      return vec4(bg, 1.);\n    }\n\n    vec4 getCameraPix() {\n      vec2 fixedUv = vec2(\n        1. - (uv.x / ratio) * 2.,\n        uv.y * 2. - 1.\n      );\n      if(\n        fixedUv.x &gt; 1. || fixedUv.x &lt; 0. ||\n        fixedUv.y &gt; 1. || fixedUv.y &lt; 0.\n      ) return vec4(0., 1., 0., 1.);\n      vec4 pix = texture(capture, fixedUv);\n      return pix;\n    }\n\n    vec4 mixCapture(vec4 bg, vec4 cameraPix) {\n      vec3 diff = cameraPix.rgb - vec3(0., 1., 0.);\n      float fac = smoothstep(\n        threshold - padding,\n        threshold + padding,\n        dot(diff, diff)\n      );\n      return mix(cameraPix, bg, 1. - fac);\n    }\n    ---\n    vec4 bg = getBg();\n    vec4 cameraPix = getCameraPix();\n\t  fragColor = mixCapture(bg, cameraPix);\n  `)\n}\n\nconst uniforms = {}\nfunction draw() {\n  if (capture) uniforms.capture = capture\n  const graphics = tina.update(uniforms)\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;basic-fft-mic&quot;],&quot;sketch&quot;:[0,&quot;let tina, fft, mic, spectrum\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(width, height)\n\n  const bands = 512\n\n  fft = new p5.FFT(0, bands)\n  mic = new p5.AudioIn()\n  mic.start()\n  fft.setInput(mic)\n\n  spectrum = fft.analyze()\n\n  setInterval(() =&gt; {\n    spectrum = fft.analyze()\n    for (let i = 0; i &lt; spectrum.length; i++) {\n      let spec = spectrum[i] || 0\n      spec = map(spec, 0, 255, 0, 1)\n      spectrum[i] = spec\n    }\n  }, 1000 / 30)\n\n  tina.build(/* glsl */ `\n    uniform sampler2D graphics;\n    uniform float spectrum[${bands}];\n\n    ---\n\n    vec2 coord = uv * vec2(width, height);\n    coord.x += 1.;\n\n    vec4 prev = texture(\n      graphics,\n      coord / vec2(width, height)\n    );\n\n    bool isCurrent = coord.x &gt; width - 1.;\n\n    if(isCurrent) {\n      float freq = 1. - uv.y;\n      float spec = spectrum[int(freq * ${bands}.)];\n      float amp = pow(sin(spec * PI / 2.), 2.);\n      fragColor = vec4(\n        hsv2rgb(freq, 1. - amp, amp), 1.\n      );\n    } else {\n      fragColor = vec4(prev.rgb, 1.);\n    }\n  `)\n}\n\nlet graphics\nfunction draw() {\n  const uniforms = { spectrum }\n  if (graphics) uniforms.graphics = graphics\n  graphics = tina.update(uniforms)\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;basic-game-of-life&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(100 * (width / height), 100)\n\n  tina.build(/* glsl */ `\n    uniform sampler2D graphics;\n\n    float getState(vec2 p) {\n      vec4 data = texture(graphics, p);\n      return step(.5, length(data.rgb));\n    }\n\n    ---\n\n    vec2 res = vec2(width, height);\n\n    float n = 0.;\n    for(float i = -1.; i &lt;= 1.; i++)\n      for(float j = -1.; j &lt;= 1.; j++)\n        n += getState(\n          uv + vec2(i, j) / res\n        );\n\n    float live = getState(uv);\n    n -= live;\n\n    vec2 circlePos = (2. * uv - 1.);\n    circlePos.x *= width / height;\n    circlePos += vec2(cos(time) * .5, sin(time) * .5);\n    float circleDist = length(circlePos);\n\n    if(circleDist &lt; .1) {\n      fragColor = vec4(1.);\n    } else {\n      if(n == 3.) live = 1.;\n      else if(n &gt; 3. || n &lt;= 1.) live = 0.;\n      fragColor = vec4(vec3(live), 1.);\n    }\n  `)\n\n  frameRate(24)\n  noSmooth()\n}\n\nlet graphics\nfunction draw() {\n  const uniforms = {}\n  if (graphics) uniforms.graphics = graphics\n  graphics = tina.update(uniforms)\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;basic-k-means&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n  tina = new Tina(width, height)\n\n  tina.build(/* glsl */ `\n    uniform float mouseX;\n    uniform float mouseY;\n    const int nPoints = 10;\n    const float centDist = 5.;\n    ---\n    vec2 xy = uv * vec2(width, height);\n\n    float minD = 1e9;\n    int minIndex = -1;\n    float t = time * 0.01;\n    for (int i = 0; i &lt; nPoints; i++) {\n      float x = (snoise(vec3(0., float(i), t)) * .5 + .5) * width;\n      float y = (snoise(vec3(1., float(i), t)) * .5 + .5) * height;\n      float d = length(xy - vec2(x, y));\n      if (d &lt; minD) {\n        minD = d;\n        minIndex = i;\n      }\n    }\n\n    float dMouse = length(xy - vec2(mouseX, mouseY));\n    float hue = float(minIndex) / float(nPoints - 1);\n    if (dMouse &lt; minD) {\n      hue = .1;\n      minD = dMouse;\n    }\n\n    vec3 color = mix(\n      hsv2rgb(hue, .6, 1.),\n      vec3(0.),\n      log(minD / 20.) / 3.\n    );\n    fragColor = vec4(color, 1.);\n  `)\n\n  noCursor()\n}\n\nfunction draw() {\n  const graphics = tina.update({\n    mouseX,\n    mouseY,\n  })\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;basic-patterns&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n  tina = new Tina(width * 2, height * 2)\n\n  tina.build(/* glsl */ `\n    #define turn(x) pow(abs(cos(x)), 2.)\n    float dWave(vec2 xy, float A) {\n      float d = xy.y - A * (\n        asin(sin(xy.x)) * turn(time * .1) +\n        sin(xy.x)       * turn(time * .1 + PI/2.)\n      );\n      return d;\n    }\n    float dFilledWave(vec2 xy, float A, float w) {\n      float d1 = dWave(xy + vec2(0.,  w), A);\n      float d2 = dWave(xy + vec2(0., -w), A);\n      return d1 * d2;\n    }\n    float dShape(vec2 xy, float offset) {\n      float A =\n        .06 * turn(time * .1) +\n        .03 * turn(time * .1 + PI/2.);\n      float w = A * PI / 2.;\n      float f = 1. / A;\n      float s = A * TWO_PI;\n      xy.y = xy.y - s * round(xy.y / s);\n      xy = xy * vec2(f, 1.) + vec2(-offset, 0.);\n      return dFilledWave(xy, A, w);\n    }\n    ---\n    vec2 xy = uv * 2. - 1.; xy.x *= (width / height);\n\n    vec2 polar = toPolar(xy);\n    float sections = 8.;\n    polar.y = mod(polar.y, PI / (sections / 2.));\n    xy = toCartesian(polar);\n\n    vec3 c1 = hsv2rgb(.0, 1., 1.);\n    c1 *= step(dShape(xy,  time), 0.); // smoothstep(.0005, 0., dShape(xy,  time))\n    vec3 c2 = hsv2rgb(.5, 1., 1.);\n    c2 *= step(dShape(xy, -time), 0.);\n\n    fragColor = vec4(max(c1, c2), 1.);\n  `)\n}\n\nfunction draw() {\n  const graphics = tina.update()\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-modeling&quot;],&quot;sketch&quot;:[0,&quot;let tina\nconst spherical = [2, 0, 0]\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(240 * (width / height), 240, { useInterlacing: true })\n\n  tina.pointLight({\n    pos: [0, 0, 2],\n    color: [0.8, 0.8, 0.75],\n    power: 6,\n    computeShadows: true,\n  })\n  tina.pointLight({\n    pos: [1, 1, 2],\n  })\n\n  // Head\n  tina.box({\n    color: [0.5, 0.5, 0.5],\n    dimensions: [0.26, 0.14, 0.1],\n    smoothFactor: 0.5,\n  })\n  tina.sphere({\n    shininess: 3,\n    color: [0.9, 0.6, 0.4],\n  })\n\n  // Sun glasses\n  tina.box({\n    shininess: 1024,\n    pos: [-0.15, 0.05, 0.23],\n    radius: 0.18,\n    dimensions: [0.12, 0.08, 0.001],\n    smoothFactor: 0.02,\n  })\n  tina.box({\n    shininess: 1024,\n    pos: [0.15, 0.05, 0.23],\n    radius: 0.18,\n    dimensions: [0.12, 0.08, 0.001],\n    smoothFactor: 0.02,\n  })\n  tina.capsule({\n    shininess: 1024,\n    pos: [0, 0.1, 0.23],\n    start: [0.05, 0, 0],\n    end: [-0.05, 0, 0],\n    radius: 0.01,\n  })\n\n  // Body\n  tina.capsule({\n    shininess: 10,\n    color: [0, 0.5, 0],\n    start: [0, -0.32, 0],\n    end: [0, -0.4, 0],\n    radius: 0.08,\n    smoothFactor: 0.05,\n  })\n  tina.capsule({\n    shininess: 10,\n    color: [0, 0.5, 0],\n    start: [-0.04, -0.45, 0],\n    end: [-0.07, -0.55, 0],\n    radius: 0.05,\n    smoothFactor: 0.05,\n  })\n  tina.capsule({\n    shininess: 10,\n    color: [0, 0.5, 0],\n    start: [0.04, -0.45, 0],\n    end: [0.07, -0.55, 0],\n    radius: 0.05,\n  })\n\n  // Floor\n  tina.box({\n    shininess: 1024,\n    pos: [0, -1, 0],\n    dimensions: [1, 0.01, 1],\n  })\n  // Wall\n  tina.box({\n    shininess: 1024,\n    pos: [0, 0, -1],\n    dimensions: [1, 1, 0.01],\n  })\n\n  tina.minBright = 0.3\n  tina.build(`\n    Scene scene = calcScene();\n    if(scene.materialIndex == -1) {\n      scene.color.rgb = vec3(.1, .1, .1);\n    } else {\n      scene.color.rgb = pow(scene.color.rgb, vec3(1.5));\n    }\n    fragColor = scene.color;\n  `)\n  tina.fov = 60\n  noSmooth()\n}\n\nfunction draw() {\n  tina.spherical = spherical\n\n  const graphics = tina.update()\n\n  image(graphics, 0, 0, width, height)\n}\n\nfunction mouseDragged() {\n  spherical[1] -= movedX / 100\n  spherical[2] -= movedY / 100\n}\n\nfunction mouseWheel(event) {\n  if (event.delta &gt; 0) {\n    spherical[0] += 0.03\n  } else {\n    spherical[0] -= 0.03\n  }\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-morphology&quot;],&quot;sketch&quot;:[0,&quot;let tina, thing\n\nfunction setup() {\n    createCanvas(windowWidth, windowHeight)\n    tina = new Tina(width, height)\n\n    tina.pos = [0, 0, 2]\n\n    const bounce = &#39;pow(sin(time * .2), 2.)&#39;;\n    thing = tina.shape({\n        sdFunc: `(\n            sdTorus(pos, vec2(.8, .2))\n        ) * ${bounce} + (\n            sdBox(pos, vec3(.6))\n        ) * (1. - ${bounce})`,\n        shininess: 2048,\n        color: [0, 0.9, 0.8],\n    })\n\n    tina.build()\n    tina.fov = 100\n}\n\n\nfunction draw() {\n    thing.rotation[0] += 0.006\n    thing.rotation[1] += 0.006\n    const graphics = tina.update()\n    image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-periodic-surface&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(width, height)\n\n  tina.shape({\n    sdFunc: `(sin(pos.y) - (cos(pos.x) + cos(pos.y) + cos(pos.z))) / 2.`,\n  })\n\n  tina.build(/* glsl */ `\n    uniform float pulse;\n    ---\n    vec2 dir2d = uv * 2. - 1.;\n    dir2d *= vec2(width / height, -1);\n\n    float t = time * .3;\n    vec3 ro = vec3(cos(-t) * 16., 2.4, sin(-t) * 16.);\n    vec3 rd = normalize(vec3(dir2d, -.8));\n    rd *= rotate(vec3(0., t, -t));\n\n    fragColor = vec4(0., 0., 0., 1.);\n\n    RayMarch rm = rayMarch(ro, rd);\n    if(rm.materialIndex == -1) return;\n\n    vec3 color = calcSceneNormal(rm.pos) / 2. + .5;\n    float dist = length(rm.pos - ro);\n    float bri = pow(sin(dist * PI / 6.), 6.);\n    color *= (bri + pulse);\n\n    fragColor = vec4(color, 1.);\n  `)\n}\n\nlet pulse = 0\nfunction draw() {\n  const graphics = tina.update({\n    pulse,\n  })\n  image(graphics, 0, 0, width, height)\n  pulse -= 0.06\n  pulse = max(0, pulse)\n}\n\nfunction mousePressed() {\n  pulse = 0.6\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-physics&quot;],&quot;sketch&quot;:[0,&quot;let player,\n  tina,\n  lights = [],\n  table\n\nfunction Player() {\n  this.initialPos = [0, 2, 0]\n  this.onTheFloor = false\n  this.group = tina.parent({})\n  this.body = new CapsuleCollisions({\n    collisionGroup: this.group,\n    pos: [...this.initialPos],\n    end: [0, -0.2, 0],\n    radius: 0.05,\n  })\n  this.acc = 0.003\n\n  this.move = (move) =&gt; {\n    const yAngle = tina.spherical[1]\n\n    if (move === &#39;UP&#39; &amp;&amp; this.onTheFloor) {\n      this.body.vel[1] += 0.06\n    }\n    if (move === &#39;DOWN&#39;) {\n      this.body.vel[1] -= 0.005\n    }\n\n    const slowDown = this.onTheFloor ? 1 : 0.3\n\n    if (move === &#39;FRONT&#39;) {\n      this.body.vel[0] -= this.acc * sin(yAngle) * slowDown\n      this.body.vel[2] -= this.acc * cos(yAngle) * slowDown\n    }\n    if (move === &#39;BACK&#39;) {\n      this.body.vel[0] += this.acc * sin(yAngle) * slowDown\n      this.body.vel[2] += this.acc * cos(yAngle) * slowDown\n    }\n    if (move === &#39;LEFT&#39;) {\n      this.body.vel[0] -= this.acc * cos(yAngle) * slowDown\n      this.body.vel[2] += this.acc * sin(yAngle) * slowDown\n    }\n    if (move === &#39;RIGHT&#39;) {\n      this.body.vel[0] += this.acc * cos(yAngle) * slowDown\n      this.body.vel[2] -= this.acc * sin(yAngle) * slowDown\n    }\n  }\n}\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(...getResolution(), { useInterlacing: true })\n  player = new Player()\n\n  tina.spherical = [0.6, 0, -0.5]\n  tina.minBright = 0.1\n\n  tina.sphere({\n    parentIndex: player.group,\n    collisionGroup: player.group,\n    shininess: 512,\n    radius: 0.08,\n    smoothFactor: 0.05,\n  })\n\n  tina.capsule({\n    parentIndex: player.group,\n    collisionGroup: player.group,\n    shininess: 512,\n    color: [1, 0, 1],\n    radius: player.body.radius,\n    end: player.body.end,\n  })\n\n  tina.sphere({\n    shininess: 512,\n    color: [1, 1, 1],\n    pos: [-1, 0.3, 0],\n    smoothFactor: 0.2,\n  })\n\n  table = tina.box({\n    shininess: 512,\n    color: [1, 0, 1],\n    dimensions: [0.4, 0.05, 0.4],\n  })\n\n  tina.shape({\n    sdFunc: `pos.y + 0.1`,\n    smoothFactor: 0.1,\n  })\n\n  tina.box({\n    rotation: [-0.6, 0, 0],\n    pos: [1, 0, 0],\n    dimensions: [0.2, 0.01, 0.3],\n  })\n\n  tina.box({\n    rotation: [0, 0, 0],\n    pos: [1, 0.168, -0.54],\n    dimensions: [0.2, 0.01, 0.3],\n  })\n\n  tina.box({\n    pos: [-2, 0.4, 0],\n    dimensions: [0.004, 0.5, 0.5],\n  })\n\n  tina.sphere({\n    pos: [20, 3, 0],\n    radius: 3,\n  })\n\n  tina.pointLight({\n    pos: [20, 3, 0],\n    color: [0.9, 0.9, 0.6],\n    computeShadows: true,\n    offsetRadius: 3.01,\n    power: 2000,\n  })\n\n  lights[0] = tina.pointLight({\n    color: [1, 0, 0],\n    power: 3,\n  })\n\n  lights[1] = tina.pointLight({\n    color: [0, 1, 0],\n    power: 3,\n  })\n\n  lights[2] = tina.pointLight({\n    color: [0, 0, 1],\n    power: 3,\n  })\n\n  tina.build(/* glsl */ `\n    Scene scene = calcScene();\n    if(scene.materialIndex == -1 &amp;&amp; !scene.interlaced) {\n      vec3 temp = scene.rd * 5.;\n      float n0 = snoise(temp);\n      float n1 = snoise(vec3(n0, temp.x, time * .5));\n      float n2 = snoise(vec3(n0, temp.y, time * .5));\n      float n3 = snoise(vec3(n0, temp.z, time * .5));\n      scene.color.rgb = hsv2rgb(n1, n2, n3)  * .5;\n    }\n    fragColor = scene.color;\n  `)\n  player.body.build(tina)\n\n  keyboardListener({\n    Space: () =&gt; player.move(&#39;UP&#39;),\n    MetaLeft: () =&gt; player.move(&#39;DOWN&#39;),\n    ControlLeft: () =&gt; player.move(&#39;DOWN&#39;),\n    KeyW: () =&gt; player.move(&#39;FRONT&#39;),\n    KeyS: () =&gt; player.move(&#39;BACK&#39;),\n    KeyA: () =&gt; player.move(&#39;LEFT&#39;),\n    KeyD: () =&gt; player.move(&#39;RIGHT&#39;),\n  })\n\n  const physicsFreq = 1000 / 60\n  const gravity = 0.12 / 60\n  player.body.startPhysics(physicsFreq, (collisions, delta) =&gt; {\n    player.onTheFloor = collisions[1] &gt; 0.01\n\n    player.body.vel[0] *= 0.9\n    if (player.onTheFloor) player.body.vel[1] = 0\n    else player.body.vel[1] -= gravity * (1 - collisions[1]) * delta\n    player.body.vel[2] *= 0.9\n\n    // dead\n    if (player.body.pos[1] &lt; -5) {\n      player.body.vel = [0, 0, 0]\n      player.body.pos = [...player.initialPos]\n    }\n\n    tina.materials[player.group].pos = player.body.pos\n    tina.pos = player.body.pos\n  })\n\n  noSmooth()\n}\n\nfunction draw() {\n  const t = millis() / 1000\n  table.pos = [-1, 0.1 + sin(t) / 10, 0]\n  table.rotation = [0, t / 2, 0]\n\n  for (let i = 0; i &lt; lights.length; i++) {\n    lights[i].pos = [\n      cos(t + (i * TWO_PI) / lights.length) * 3,\n      2,\n      sin(t + (i * TWO_PI) / lights.length) * 3,\n    ]\n  }\n\n  const graphics = tina.update()\n\n  image(graphics, 0, 0, width, height)\n\n  fill(&#39;#00ff00&#39;)\n  noStroke()\n  ellipse(width / 2, height / 2, 4, 4)\n}\n\nfunction mouseMoved() {\n  if (!fullscreen()) return\n  tina.spherical[1] -= movedX / 300\n  tina.spherical[2] -= movedY / 300\n}\n\nfunction mouseWheel(event) {\n  if (event.delta &gt; 0) {\n    tina.spherical[0] += 0.01\n  } else {\n    tina.spherical[0] -= 0.01\n  }\n}\n\nfunction getResolution() {\n  return [360 * (width / height), 360]\n}\n\nlet resizeTimeout\nfunction windowResized() {\n  if (resizeTimeout) clearTimeout(resizeTimeout)\n  resizeTimeout = setTimeout(() =&gt; {\n    resizeCanvas(windowWidth, windowHeight)\n    tina.resize(...getResolution())\n    resizeTimeout = null\n  }, 100)\n}\n\nfunction mousePressed() {\n  if (!fullscreen()) {\n    requestPointerLock()\n    fullscreen(true)\n  }\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-simplex-noise-ocean&quot;],&quot;sketch&quot;:[0,&quot;let tina\n\nfunction setLights() {\n  const pos = createVector(800, 500, -800)\n  const sun = tina.sphere({\n    color: [1, 0.8, 0.6],\n    pos: pos.array(),\n    radius: 150,\n  })\n\n  tina.pointLight({\n    color: sun.color,\n    pos: pos.array(),\n    computeShadows: true,\n    offsetRadius: 150.01,\n    power: 7e6,\n    shadowness: 0.6,\n  })\n\n  tina.pointLight({\n    color: sun.color,\n    pos: pos.copy().mult(-1).array(),\n    offsetRadius: 150.01,\n    power: 1e6,\n  })\n}\n\nfunction setWater() {\n  tina.shape({\n    color: [0, 1, 0.9],\n    sdFunc: `\n      (\n        pos.y +\n        snoise(vec3(pos.x * .08 + time * .8, pos.z * .08, time / 2.)) * .6 +\n        snoise(vec3(pos.x * .6 + time * .6, pos.z * .8, time * 2.)) * .01\n      ) * .9\n    `,\n    shininess: 1e3,\n    smoothFactor: 1,\n  })\n}\n\nfunction setThing() {\n  tina.shape({\n    color: [0, 1, 0.9],\n    pos: tina.pos,\n    sdFunc: `(\n      length(pos) - pow((snoise(pos - time / 2.) + 1.), .3)\n    ) * .3`,\n    shininess: 1e3,\n  })\n}\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n\n  tina = new Tina(240 * (width / height), 240, { useInterlacing: true })\n  tina.pos = [0, 2, -2]\n\n  setLights()\n  setWater()\n  setThing()\n\n  tina.build(/* glsl */ `\n    Scene scene = calcScene();\n    if(scene.materialIndex == -1 &amp;&amp; !scene.interlaced) {\n      float\n      v = snoise(scene.rd * 2. + vec3(0, 0, time * .1));\n      v = snoise(scene.rd * 4. + vec3(v, v, time * .2));\n      v = snoise(scene.rd * 8. + vec3(v, v, time * .3));\n      v = max(v, 0.);\n      scene.color.rgb = mix(hsv2rgb(.6, .4, .1), vec3(.25), v) + pow(v, 16.);\n    }\n    scene.color.rgb = round(scene.color.rgb * 16.) / 16.;\n    fragColor = scene.color;\n  `)\n\n  noSmooth()\n}\n\nfunction draw() {\n  const graphics = tina.update()\n  const t = performance.now() / 1000\n  tina.spherical = [4, t * 0.1, 0]\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}],[0,{&quot;route&quot;:[0,&quot;rm-simplex-noise-terrain&quot;],&quot;sketch&quot;:[0,&quot;let tina,\n  moon = {}\n\nfunction setup() {\n  createCanvas(windowWidth, windowHeight)\n  tina = new Tina(240 * (width / height), 240, { useInterlacing: true })\n\n  tina.shape({\n    sdFunc: `(\n      pos.y - snoise(vec3(pos.xz, pos.y - time / 10.))\n    ) / 7.`,\n    shininess: 1024,\n  })\n\n  moon.sphere = tina.sphere({\n    radius: 1,\n  })\n\n  moon.pl = tina.pointLight({\n    color: [0.9, 1, 1],\n    power: 20,\n    computeShadows: true,\n    offsetRadius: 1.01,\n    shadowness: 0.5,\n  })\n\n  tina.build(/* glsl */ `\n    Scene scene = calcScene();\n    fragColor = round(scene.color * 32.) / 32.;\n  `)\n\n  noSmooth()\n}\n\nfunction draw() {\n  const time = performance.now() / 1000\n\n  tina.spherical = [0.1, sin(time / 2) / 2, -0.3]\n  tina.pos = [0, 0.6, -time / 4]\n\n  moon.pl.pos = [0, 1.5, tina.pos[2] - 5]\n  moon.sphere.pos = moon.pl.pos\n\n  const graphics = tina.update()\n  image(graphics, 0, 0, width, height)\n}\n&quot;]}]]],&quot;data-astro-cid-j7pv25f6&quot;:[0,true]}" ssr client="load" opts="{&quot;name&quot;:&quot;TinaExamples&quot;,&quot;value&quot;:true}" await-children><ul><li><button class="underline">basic-2d-vector-field</button></li><li><button class="underline">basic-camera-green-screen</button></li><li><button class="underline">basic-fft-mic</button></li><li><button class="underline">basic-game-of-life</button></li><li><button class="underline">basic-k-means</button></li><li><button class="underline">basic-patterns</button></li><li><button class="underline">rm-modeling</button></li><li><button class="underline">rm-morphology</button></li><li><a href="/rm-periodic-surface" target="_blank" class="underline text-primary">rm-periodic-surface</a> â€” Click again to open in new tab</li><li><button class="underline">rm-physics</button></li><li><button class="underline">rm-simplex-noise-ocean</button></li><li><button class="underline">rm-simplex-noise-terrain</button></li></ul><iframe src="/rm-periodic-surface" height="400" width="100%"></iframe><h1>rm-periodic-surface</h1><p>Copy and paste it in:<!-- --> <a href="https://editor.p5js.org/" target="_blank" class="text-primary">editor.p5js.org</a></p><pre class="bg-[#282c34] relative"><button class="top-2 right-2 px-2 rounded absolute text-sm border">Copy</button><code class="hljs language-javascript"><span class="hljs-keyword">const</span> lib = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;script&quot;</span>);
lib.<span class="hljs-property">src</span> = <span class="hljs-string">&quot;https://moloxe.github.io/tina/lib.js&quot;</span>;
<span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(lib);

<span class="hljs-keyword">let</span> tina

<span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) {
  <span class="hljs-title function_">createCanvas</span>(windowWidth, windowHeight)

  tina = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tina</span>(width, height)

  tina.<span class="hljs-title function_">shape</span>({
    <span class="hljs-attr">sdFunc</span>: <span class="hljs-string">`(sin(pos.y) - (cos(pos.x) + cos(pos.y) + cos(pos.z))) / 2.`</span>,
  })

  tina.<span class="hljs-title function_">build</span>(<span class="hljs-comment">/* glsl */</span> <span class="hljs-string">`
    uniform float pulse;
    ---
    vec2 dir2d = uv * 2. - 1.;
    dir2d *= vec2(width / height, -1);

    float t = time * .3;
    vec3 ro = vec3(cos(-t) * 16., 2.4, sin(-t) * 16.);
    vec3 rd = normalize(vec3(dir2d, -.8));
    rd *= rotate(vec3(0., t, -t));

    fragColor = vec4(0., 0., 0., 1.);

    RayMarch rm = rayMarch(ro, rd);
    if(rm.materialIndex == -1) return;

    vec3 color = calcSceneNormal(rm.pos) / 2. + .5;
    float dist = length(rm.pos - ro);
    float bri = pow(sin(dist * PI / 6.), 6.);
    color *= (bri + pulse);

    fragColor = vec4(color, 1.);
  `</span>)
}

<span class="hljs-keyword">let</span> pulse = <span class="hljs-number">0</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> graphics = tina.<span class="hljs-title function_">update</span>({
    pulse,
  })
  <span class="hljs-title function_">image</span>(graphics, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height)
  pulse -= <span class="hljs-number">0.06</span>
  pulse = <span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, pulse)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">mousePressed</span>(<span class="hljs-params"></span>) {
  pulse = <span class="hljs-number">0.6</span>
}
</code></pre><!--astro:end--></astro-island> </main>  </body></html> <footer class="py-16 flex justify-between max-w-2xl m-auto p-2" data-astro-cid-j7pv25f6> <p data-astro-cid-j7pv25f6>
Â© 2024. All content and pages are licensed under
<a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/" class="hover:text-white" data-astro-cid-j7pv25f6>CC BY-SA 4.0</a> </p> <a href="/" data-astro-cid-j7pv25f6>Home</a> </footer> 