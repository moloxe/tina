---
import Layout from '../layouts/Layout.astro'

const { scene } = Astro.params
const { sketch } = Astro.props

export async function getStaticPaths() {
  const files = import.meta.glob('@src/scenes/*.js', {
    eager: false,
    query: '?raw',
  })
  const paths = Object.keys(files)
  const filenames: { name: string; sketch: string }[] = []

  for (let index = 0; index < paths.length; index++) {
    const path = paths[index]
    const name = path.split('/').pop()?.replace('.js', '') ?? ''
    const sketch = ((await files[path]()) as any).default as string
    filenames.push({ name, sketch })
  }

  return filenames.map(({ name, sketch }) => ({
    params: { scene: name },
    props: { sketch },
  }))
}
---

<Layout title={scene} sketch={sketch} />
